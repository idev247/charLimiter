/*
    Project: charLimiter
    Version: 1.1
    Date: 10/01/2013
    Description: Characters Limiter and auto generate Counter if you can.
    Author: Abner Soares Alves JÃºnior
    GitHub: https://github.com/abnersajr
    Licensed under the MIT license
 */
(function(e,t,n){function o(t,n){var i=this.element=t;var o=this.options=e.extend({maxChars:!e(i).attr("maxlength")?e(i).data(r.toLowerCase()+"-limit"):e(i).attr("maxlength"),onCharsFull:function(){},onCharsEmpty:function(){},onCharsValid:function(){}},s,n);if(!o.maxChars){return}this._defaults=s;this._name=r;this.init(i,o)}var r="charLimiter",i=t.document,s={counterClass:"counter",generateCounter:false,insert:"after",forceLimit:true,textFormat:"{r}"};o.prototype.init=function(t,n){var r=n.maxChars;if(n.generateCounter===true){var i=e("<span>",{"class":n.counterClass,text:r});e(t).data("sp",i)[n.insert](i)}else{e(t).each(function(){e("."+n.counterClass+'[data-counter-rel="'+e(this).data("counter-rel")+'"]').html(r)})}e(t).on("keypress keyup keydown change input",function(){var t;var i=e(this).val().length;var s=r-i;if(s<=0){n.onCharsFull(this)}else{if(i===0){n.onCharsEmpty(this)}n.onCharsValid(this)}if(n.forceLimit&&i>r){var o=e(this).val();e(this).val(o.substr(0,r));s=0}t=n.textFormat.replace(/{r}/g,s).replace(/{rs}/g,s===1||s===-1?"":"s").replace(/{c}/g,i).replace(/{cs}/g,i===1||s===-1?"":"s").replace(/{m}/g,r);if(n.generateCounter===true){e(this).data("sp").html(t)}else{e("."+n.counterClass+'[data-counter-rel="'+e(this).data("counter-rel")+'"]').html(t)}}).change()};e.fn[r]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+r)){e.data(this,"plugin_"+r,new o(this,t))}})}})(jQuery,window)
